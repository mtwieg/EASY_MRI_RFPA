Version 4
SHEET 1 5344 3112
WIRE 160 -1280 -1632 -1280
WIRE -1536 -1152 -1536 -1184
WIRE -560 -960 -608 -960
WIRE -1344 -928 -1408 -928
WIRE -944 -928 -992 -928
WIRE -928 -928 -944 -928
WIRE -704 -928 -864 -928
WIRE -160 -928 -224 -928
WIRE -64 -928 -96 -928
WIRE -1408 -912 -1408 -928
WIRE 944 -912 368 -912
WIRE -1536 -896 -1536 -912
WIRE -1456 -896 -1536 -896
WIRE -1536 -880 -1536 -896
WIRE -560 -880 -608 -880
WIRE -992 -864 -992 -928
WIRE -704 -848 -704 -928
WIRE -672 -848 -704 -848
WIRE -176 -848 -224 -848
WIRE -320 -816 -320 -848
WIRE -288 -816 -320 -816
WIRE -176 -816 -176 -848
WIRE -176 -816 -224 -816
WIRE -816 -800 -816 -816
WIRE -1536 -784 -1536 -800
WIRE -672 -768 -720 -768
WIRE -560 -768 -560 -880
WIRE -560 -768 -608 -768
WIRE 544 -768 432 -768
WIRE 656 -768 624 -768
WIRE 752 -768 656 -768
WIRE 768 -768 752 -768
WIRE -720 -752 -720 -768
WIRE -720 -752 -752 -752
WIRE -560 -752 -560 -768
WIRE -496 -752 -560 -752
WIRE -64 -752 -64 -928
WIRE -16 -752 -64 -752
WIRE 432 -752 432 -768
WIRE 656 -752 656 -768
WIRE 768 -752 768 -768
WIRE -720 -736 -720 -752
WIRE -672 -736 -720 -736
WIRE -560 -736 -560 -752
WIRE -560 -736 -608 -736
WIRE -288 -736 -336 -736
WIRE -176 -736 -224 -736
WIRE -336 -720 -336 -736
WIRE -336 -720 -416 -720
WIRE -64 -720 -64 -752
WIRE -496 -704 -496 -752
WIRE -336 -704 -336 -720
WIRE -288 -704 -336 -704
WIRE -176 -704 -176 -736
WIRE -176 -704 -224 -704
WIRE -672 -656 -720 -656
WIRE -720 -624 -720 -656
WIRE -560 -624 -560 -736
WIRE -560 -624 -608 -624
WIRE -288 -624 -336 -624
WIRE -176 -624 -224 -624
WIRE -336 -592 -336 -624
WIRE -176 -592 -176 -624
WIRE -176 -592 -224 -592
WIRE -560 -544 -608 -544
WIRE -512 -544 -560 -544
WIRE -560 -512 -560 -544
WIRE -176 -512 -224 -512
WIRE -176 -480 -176 -512
WIRE 368 -480 368 -912
WIRE 944 -480 944 -912
WIRE 944 -480 368 -480
WIRE 944 -448 944 -480
WIRE -1632 -432 -1632 -1280
WIRE 160 -432 160 -1280
WIRE 160 -432 -1632 -432
WIRE 160 -400 160 -432
WIRE -144 -336 -176 -336
WIRE 16 -336 -64 -336
WIRE -144 -240 -208 -240
WIRE 16 -240 16 -336
WIRE 16 -240 -64 -240
WIRE 80 -240 16 -240
WIRE 16 -224 16 -240
WIRE -352 -160 -368 -160
WIRE -256 -160 -272 -160
WIRE -208 -160 -208 -240
WIRE 48 -144 16 -144
WIRE -704 -64 -784 -64
WIRE -672 -64 -704 -64
WIRE -560 -64 -592 -64
WIRE -496 -64 -560 -64
WIRE -400 -64 -400 -96
WIRE -400 -64 -432 -64
WIRE -368 -64 -368 -160
WIRE -368 -64 -400 -64
WIRE -352 -64 -368 -64
WIRE -256 -64 -256 -160
WIRE -256 -64 -272 -64
WIRE -208 -64 -208 -96
WIRE -208 -64 -256 -64
WIRE -160 -64 -208 -64
WIRE -128 -64 -160 -64
WIRE -32 -64 -48 -64
WIRE -32 -48 -32 -64
WIRE 48 -48 16 -48
WIRE -704 -32 -704 -64
WIRE -560 -32 -560 -64
WIRE -400 0 -400 -64
WIRE 16 48 16 32
WIRE 16 64 16 48
WIRE -400 96 -400 80
WIRE -400 96 -416 96
WIRE -400 112 -400 96
WIRE 16 160 16 144
WIRE -400 208 -400 192
WIRE -400 208 -432 208
WIRE -144 368 -208 368
WIRE 16 368 -64 368
WIRE 80 368 16 368
WIRE 16 384 16 368
WIRE -352 448 -368 448
WIRE -256 448 -272 448
WIRE -208 448 -208 368
WIRE 48 464 16 464
WIRE -1552 544 -1616 544
WIRE -1392 544 -1472 544
WIRE -1280 544 -1392 544
WIRE -1152 544 -1280 544
WIRE -688 544 -768 544
WIRE -656 544 -688 544
WIRE -544 544 -576 544
WIRE -496 544 -544 544
WIRE -400 544 -400 512
WIRE -400 544 -432 544
WIRE -368 544 -368 448
WIRE -368 544 -400 544
WIRE -352 544 -368 544
WIRE -256 544 -256 448
WIRE -256 544 -272 544
WIRE -208 544 -208 512
WIRE -208 544 -256 544
WIRE -160 544 -208 544
WIRE -128 544 -160 544
WIRE -32 544 -48 544
WIRE -1392 560 -1392 544
WIRE -32 560 -32 544
WIRE 48 560 16 560
WIRE -688 576 -688 544
WIRE -544 576 -544 544
WIRE -400 608 -400 544
WIRE -1760 624 -1776 624
WIRE -1664 624 -1680 624
WIRE -1616 624 -1616 544
WIRE -1360 640 -1392 640
WIRE 16 656 16 640
WIRE -1152 672 -1152 544
WIRE -1104 672 -1152 672
WIRE 16 672 16 656
WIRE -2464 720 -2544 720
WIRE -2384 720 -2464 720
WIRE -2352 720 -2384 720
WIRE -2240 720 -2272 720
WIRE -1904 720 -2240 720
WIRE -1808 720 -1808 688
WIRE -1808 720 -1840 720
WIRE -1776 720 -1776 624
WIRE -1776 720 -1808 720
WIRE -1760 720 -1776 720
WIRE -1664 720 -1664 624
WIRE -1664 720 -1680 720
WIRE -1616 720 -1616 688
WIRE -1616 720 -1664 720
WIRE -1568 720 -1616 720
WIRE -1536 720 -1568 720
WIRE -1440 720 -1456 720
WIRE -400 720 -400 688
WIRE -400 720 -416 720
WIRE -1440 736 -1440 720
WIRE -1360 736 -1392 736
WIRE -400 736 -400 720
WIRE -2384 752 -2384 720
WIRE -2240 752 -2240 720
WIRE -1104 752 -1152 752
WIRE 16 768 16 752
WIRE -1808 784 -1808 720
WIRE -1152 784 -1152 752
WIRE -1104 784 -1152 784
WIRE -1008 784 -1008 752
WIRE -1008 784 -1040 784
WIRE -2464 800 -2464 720
WIRE -1392 832 -1392 816
WIRE -400 832 -400 816
WIRE -400 832 -432 832
WIRE -1392 848 -1392 832
WIRE -1104 864 -1152 864
WIRE -992 864 -1040 864
WIRE -144 864 -176 864
WIRE 16 864 -64 864
WIRE -1808 880 -1808 864
WIRE -1808 880 -1824 880
WIRE -1152 880 -1152 864
WIRE -1152 880 -1200 880
WIRE -992 880 -992 864
WIRE -960 880 -992 880
WIRE -1808 896 -1808 880
WIRE -1152 896 -1152 880
WIRE -1104 896 -1152 896
WIRE -992 896 -992 880
WIRE -992 896 -1040 896
WIRE -960 912 -960 880
WIRE -1392 944 -1392 928
WIRE -144 960 -208 960
WIRE 16 960 16 864
WIRE 16 960 -64 960
WIRE 80 960 16 960
WIRE -1104 976 -1152 976
WIRE -992 976 -1040 976
WIRE 16 976 16 960
WIRE -1808 992 -1808 976
WIRE -1808 992 -1840 992
WIRE -1152 1008 -1152 976
WIRE -1104 1008 -1152 1008
WIRE -992 1008 -992 976
WIRE -352 1040 -368 1040
WIRE -256 1040 -272 1040
WIRE -208 1040 -208 960
WIRE 48 1056 16 1056
WIRE -1104 1088 -1152 1088
WIRE -688 1136 -768 1136
WIRE -656 1136 -688 1136
WIRE -544 1136 -576 1136
WIRE -496 1136 -544 1136
WIRE -400 1136 -400 1104
WIRE -400 1136 -432 1136
WIRE -368 1136 -368 1040
WIRE -368 1136 -400 1136
WIRE -352 1136 -368 1136
WIRE -256 1136 -256 1040
WIRE -256 1136 -272 1136
WIRE -208 1136 -208 1104
WIRE -208 1136 -256 1136
WIRE -160 1136 -208 1136
WIRE -128 1136 -160 1136
WIRE -32 1136 -48 1136
WIRE -1552 1152 -1616 1152
WIRE -1392 1152 -1472 1152
WIRE -1280 1152 -1392 1152
WIRE -1152 1152 -1152 1088
WIRE -1152 1152 -1280 1152
WIRE -32 1152 -32 1136
WIRE 48 1152 16 1152
WIRE -1392 1168 -1392 1152
WIRE -688 1168 -688 1136
WIRE -544 1168 -544 1136
WIRE -400 1200 -400 1136
WIRE -1760 1232 -1776 1232
WIRE -1664 1232 -1680 1232
WIRE -1616 1232 -1616 1152
WIRE -1360 1248 -1392 1248
WIRE 16 1248 16 1232
WIRE 16 1264 16 1248
WIRE -400 1296 -400 1280
WIRE -400 1296 -416 1296
WIRE -400 1312 -400 1296
WIRE -2464 1328 -2544 1328
WIRE -2352 1328 -2464 1328
WIRE -2320 1328 -2352 1328
WIRE -2208 1328 -2240 1328
WIRE -1904 1328 -2208 1328
WIRE -1808 1328 -1808 1296
WIRE -1808 1328 -1840 1328
WIRE -1776 1328 -1776 1232
WIRE -1776 1328 -1808 1328
WIRE -1760 1328 -1776 1328
WIRE -1664 1328 -1664 1232
WIRE -1664 1328 -1680 1328
WIRE -1616 1328 -1616 1296
WIRE -1616 1328 -1664 1328
WIRE -1568 1328 -1616 1328
WIRE -1536 1328 -1568 1328
WIRE -1440 1328 -1456 1328
WIRE -1440 1344 -1440 1328
WIRE -1360 1344 -1392 1344
WIRE -2352 1360 -2352 1328
WIRE -2208 1360 -2208 1328
WIRE 16 1360 16 1344
WIRE -1808 1392 -1808 1328
WIRE -400 1408 -400 1392
WIRE -400 1408 -432 1408
WIRE -2464 1424 -2464 1328
WIRE -1392 1440 -1392 1424
WIRE -1392 1456 -1392 1440
WIRE -1808 1488 -1808 1472
WIRE -1808 1488 -1824 1488
WIRE -1808 1504 -1808 1488
WIRE -144 1536 -208 1536
WIRE 16 1536 -64 1536
WIRE 80 1536 16 1536
WIRE -1392 1552 -1392 1536
WIRE 16 1552 16 1536
WIRE -1808 1600 -1808 1584
WIRE -1808 1600 -1840 1600
WIRE -352 1616 -368 1616
WIRE -256 1616 -272 1616
WIRE -208 1616 -208 1536
WIRE 48 1632 16 1632
WIRE -688 1712 -768 1712
WIRE -656 1712 -688 1712
WIRE -544 1712 -576 1712
WIRE -496 1712 -544 1712
WIRE -400 1712 -400 1680
WIRE -400 1712 -432 1712
WIRE -368 1712 -368 1616
WIRE -368 1712 -400 1712
WIRE -352 1712 -368 1712
WIRE -256 1712 -256 1616
WIRE -256 1712 -272 1712
WIRE -208 1712 -208 1680
WIRE -208 1712 -256 1712
WIRE -160 1712 -208 1712
WIRE -128 1712 -160 1712
WIRE -32 1712 -48 1712
WIRE -32 1728 -32 1712
WIRE 48 1728 16 1728
WIRE -688 1744 -688 1712
WIRE -544 1744 -544 1712
WIRE -400 1776 -400 1712
WIRE 16 1824 16 1808
WIRE 16 1840 16 1824
WIRE -400 1888 -400 1856
WIRE -400 1888 -416 1888
WIRE -400 1904 -400 1888
WIRE 16 1936 16 1920
WIRE -400 2000 -400 1984
WIRE -400 2000 -432 2000
WIRE -1616 2112 -1632 2112
WIRE -1504 2112 -1536 2112
WIRE -1408 2112 -1440 2112
WIRE -864 2128 -880 2128
WIRE -752 2128 -784 2128
WIRE -656 2128 -688 2128
WIRE -1792 2240 -1856 2240
WIRE -1664 2240 -1712 2240
WIRE -1632 2240 -1632 2112
WIRE -1632 2240 -1664 2240
WIRE -1584 2240 -1632 2240
WIRE -1408 2256 -1408 2112
WIRE -1408 2256 -1520 2256
WIRE -1328 2256 -1408 2256
WIRE -1040 2256 -1104 2256
WIRE -912 2256 -960 2256
WIRE -880 2256 -880 2128
WIRE -880 2256 -912 2256
WIRE -832 2256 -880 2256
WIRE -1584 2272 -1616 2272
WIRE -656 2272 -656 2128
WIRE -656 2272 -768 2272
WIRE -576 2272 -656 2272
WIRE -832 2288 -864 2288
WIRE -1040 2336 -1104 2336
WIRE -912 2336 -912 2256
WIRE -912 2336 -960 2336
WIRE -1792 2400 -1856 2400
WIRE -1664 2400 -1664 2240
WIRE -1664 2400 -1712 2400
WIRE -1040 2416 -1104 2416
WIRE -912 2416 -912 2336
WIRE -912 2416 -960 2416
WIRE -1040 2496 -1104 2496
WIRE -912 2496 -912 2416
WIRE -912 2496 -960 2496
WIRE -1728 2576 -1856 2576
WIRE -1616 2576 -1616 2272
WIRE -1616 2576 -1648 2576
WIRE -1856 2592 -1856 2576
WIRE -976 2592 -1104 2592
WIRE -864 2592 -864 2288
WIRE -864 2592 -896 2592
WIRE -1104 2608 -1104 2592
WIRE -304 2656 -304 2624
WIRE -144 2656 -144 2624
WIRE -1856 2688 -1856 2672
WIRE -1104 2704 -1104 2688
FLAG 16 160 0
FLAG -992 -784 0
FLAG -1536 -1072 0
FLAG 80 -240 dp
FLAG -160 -64 g1p
FLAG 16 48 s1p
FLAG -784 -64 in1p
FLAG -400 -96 b1p
FLAG -176 -336 VD
FLAG -432 208 VGbias
FLAG -64 -640 0
FLAG -1536 -1184 VD
FLAG -1536 -912 VGbias
FLAG -16 -752 OUT
FLAG -1536 -704 0
FLAG 432 -672 0
FLAG 656 -672 0
FLAG 768 -688 0
FLAG 752 -768 OUT_bpf
FLAG 16 768 0
FLAG 80 368 dp
FLAG -160 544 g2p
FLAG 16 656 s2p
FLAG -400 512 b2p
FLAG 16 1360 0
FLAG 80 960 dn
FLAG -160 1136 g1n
FLAG 16 1248 s1n
FLAG -400 1104 b1n
FLAG -176 864 VD
FLAG 16 1936 0
FLAG 80 1536 dn
FLAG -160 1712 g2n
FLAG 16 1824 s2n
FLAG -400 1680 b2n
FLAG -560 48 0
FLAG -704 48 0
FLAG -768 544 in1p
FLAG -544 656 0
FLAG -688 656 0
FLAG -768 1136 in1n
FLAG -544 1248 0
FLAG -688 1248 0
FLAG -768 1712 in1n
FLAG -544 1824 0
FLAG -688 1824 0
FLAG 944 -448 0
FLAG 160 -400 0
FLAG -560 -960 S1_in1p
FLAG -512 -544 S1_in1n
FLAG -944 -928 t
FLAG -176 -480 0
FLAG -320 -848 dp
FLAG -336 -592 dn
FLAG -416 -720 VD
FLAG -480 96 0
FLAG -432 832 VGbias
FLAG -480 720 0
FLAG -432 1408 VGbias
FLAG -480 1296 0
FLAG -432 2000 VGbias
FLAG -480 1888 0
FLAG -1456 -848 0
FLAG -1408 -832 0
FLAG -304 2736 0
FLAG -304 2624 VCC
FLAG -1104 2496 s2n
FLAG -1104 2416 s1n
FLAG -1104 2336 s2p
FLAG -1104 2256 s1p
FLAG -1104 2784 0
FLAG -800 2240 VCC
FLAG -144 2736 0
FLAG -144 2624 VEE
FLAG -800 2304 VEE
FLAG -1392 944 0
FLAG -1568 720 S1_g1p
FLAG -1392 832 S1_s1p
FLAG -2544 720 S1_in1p
FLAG -1808 688 S1_b1p
FLAG -1200 880 VD
FLAG -1840 992 S1_VGbias
FLAG -2240 832 0
FLAG -2384 832 0
FLAG -1888 880 0
FLAG -1008 752 in1p
FLAG -992 1008 in1n
FLAG -960 912 0
FLAG -1328 2256 S1_VGbias
FLAG -1856 2400 S1_s1n
FLAG -1856 2240 S1_s1p
FLAG -1856 2768 0
FLAG -1552 2224 VCC
FLAG -1552 2288 VEE
FLAG -1392 1552 0
FLAG -1568 1328 S1_g1n
FLAG -1392 1440 S1_s1n
FLAG -2544 1328 S1_in1n
FLAG -1808 1296 S1_b1n
FLAG -1840 1600 S1_VGbias
FLAG -2208 1440 0
FLAG -2352 1440 0
FLAG -1888 1488 0
FLAG -496 -624 0
FLAG -720 -624 0
FLAG -816 -800 0
FLAG -1280 544 S1_dp
FLAG -1280 1152 S1_dn
SYMBOL res 0 48 R0
SYMATTR InstName R1
SYMATTR Value {Rs}
SYMBOL res -48 -256 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value {Rfb}
SYMBOL cap -224 -160 R0
SYMATTR InstName C1
SYMATTR Value {Cfb}
SYMBOL res -416 -16 R0
SYMATTR InstName R3
SYMATTR Value {Rgbias}
SYMBOL res -256 -80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value {Rg_damp}
SYMBOL ind -368 -144 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value {Lg_damp}
SYMBOL cap -432 -80 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value {Csource}
SYMBOL voltage -1536 -1168 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value {VD}
SYMBOL ind -160 -320 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L3
SYMATTR Value {Ld}
SYMBOL res -80 -736 R0
SYMATTR InstName RL
SYMATTR Value {Rload_HV_SE}
SYMBOL voltage -1536 -896 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE({VG_init} {VG} {VG_tdelay} {VG_trise} {VG_trise} {VG_tpad*2+tpulse-VG_trise} 10m)
SYMATTR InstName V4
SYMBOL voltage -992 -880 R0
WINDOW 3 -46 82 Invisible 2
WINDOW 123 -40 28 Right 2
WINDOW 39 -45 52 Right 2
SYMATTR Value SINE(0 {Vin} {f0} {VG_tdelay+VG_tpad} 0 0 {tpulse*f0})
SYMATTR Value2 AC 1
SYMATTR SpiceLine Rser=50
SYMATTR InstName V2
SYMBOL bv -1536 -800 R0
WINDOW 3 24 96 Invisible 2
SYMATTR Value V=VG*smallsig()
SYMATTR InstName B1
SYMBOL bv 432 -768 R0
SYMATTR InstName B2
SYMATTR Value V=V(OUT)
SYMBOL res 640 -784 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R17
SYMATTR Value {bpf_R}
SYMBOL ind 640 -768 R0
SYMATTR InstName L15
SYMATTR Value {bpf_L}
SYMBOL cap 752 -752 R0
SYMATTR InstName C9
SYMATTR Value {bpf_C}
SYMBOL nmos -32 -144 R0
SYMATTR InstName M1
SYMATTR Value irf630
SYMATTR Prefix X
SYMBOL ind 0 -64 R0
SYMATTR InstName L17
SYMATTR Value {Lpar_S}
SYMATTR SpiceLine Rpar={EPR_S}
SYMBOL ind 0 -240 R0
SYMATTR InstName L18
SYMATTR Value {Lpar_D}
SYMATTR SpiceLine Rpar={EPR_D}
SYMBOL ind -144 -48 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L19
SYMATTR Value {Lpar_G}
SYMATTR SpiceLine Rpar={EPR_G}
SYMBOL res 0 656 R0
SYMATTR InstName R18
SYMATTR Value {Rs}
SYMBOL res -48 352 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value {Rfb}
SYMBOL cap -224 448 R0
SYMATTR InstName C10
SYMATTR Value {Cfb}
SYMBOL res -416 592 R0
SYMATTR InstName R20
SYMATTR Value {Rgbias}
SYMBOL res -256 528 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R21
SYMATTR Value {Rg_damp}
SYMBOL ind -368 464 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L16
SYMATTR Value {Lg_damp}
SYMBOL cap -432 528 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C11
SYMATTR Value {Csource}
SYMBOL nmos -32 464 R0
SYMATTR InstName M2
SYMATTR Value irf630
SYMATTR Prefix X
SYMBOL ind 0 544 R0
SYMATTR InstName L21
SYMATTR Value {Lpar_S}
SYMATTR SpiceLine Rpar={EPR_S}
SYMBOL ind 0 368 R0
SYMATTR InstName L22
SYMATTR Value {Lpar_D}
SYMATTR SpiceLine Rpar={EPR_D}
SYMBOL ind -144 560 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L23
SYMATTR Value {Lpar_G}
SYMATTR SpiceLine Rpar={EPR_G}
SYMBOL res 0 1248 R0
SYMATTR InstName R5
SYMATTR Value {Rs}
SYMBOL res -48 944 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value {Rfb}
SYMBOL cap -224 1040 R0
SYMATTR InstName C3
SYMATTR Value {Cfb}
SYMBOL res -416 1184 R0
SYMATTR InstName R7
SYMATTR Value {Rgbias}
SYMBOL res -256 1120 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value {Rg_damp}
SYMBOL ind -368 1056 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L2
SYMATTR Value {Lg_damp}
SYMBOL cap -432 1120 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value {Csource}
SYMBOL ind -160 880 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L4
SYMATTR Value {Ld}
SYMBOL nmos -32 1056 R0
SYMATTR InstName M3
SYMATTR Value irf630
SYMATTR Prefix X
SYMBOL ind 0 1136 R0
SYMATTR InstName L11
SYMATTR Value {Lpar_S}
SYMATTR SpiceLine Rpar={EPR_S}
SYMBOL ind 0 960 R0
SYMATTR InstName L12
SYMATTR Value {Lpar_D}
SYMATTR SpiceLine Rpar={EPR_D}
SYMBOL ind -144 1152 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L13
SYMATTR Value {Lpar_G}
SYMATTR SpiceLine Rpar={EPR_G}
SYMBOL res 0 1824 R0
SYMATTR InstName R9
SYMATTR Value {Rs}
SYMBOL res -48 1520 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value {Rfb}
SYMBOL cap -224 1616 R0
SYMATTR InstName C5
SYMATTR Value {Cfb}
SYMBOL res -416 1760 R0
SYMATTR InstName R11
SYMATTR Value {Rgbias}
SYMBOL res -256 1696 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value {Rg_damp}
SYMBOL ind -368 1632 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L14
SYMATTR Value {Lg_damp}
SYMBOL cap -432 1696 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C6
SYMATTR Value {Csource}
SYMBOL nmos -32 1632 R0
SYMATTR InstName M4
SYMATTR Value irf630
SYMATTR Prefix X
SYMBOL ind 0 1712 R0
SYMATTR InstName L25
SYMATTR Value {Lpar_S}
SYMATTR SpiceLine Rpar={EPR_S}
SYMBOL ind 0 1536 R0
SYMATTR InstName L26
SYMATTR Value {Lpar_D}
SYMATTR SpiceLine Rpar={EPR_D}
SYMBOL ind -144 1728 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L27
SYMATTR Value {Lpar_G}
SYMATTR SpiceLine Rpar={EPR_G}
SYMBOL res -720 -48 R0
WINDOW 3 -18 39 VRight 2
SYMATTR Value {atten_Rshunt_in}
SYMATTR InstName R13
SYMBOL res -576 -48 R0
WINDOW 3 -18 39 VRight 2
SYMATTR Value {atten_Rshunt_out}
SYMATTR InstName R14
SYMBOL res -576 -80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 -53 65 VTop 2
SYMATTR InstName R15
SYMATTR Value {atten_Rser}
SYMBOL res -704 560 R0
WINDOW 3 -18 39 VRight 2
SYMATTR Value {atten_Rshunt_in}
SYMATTR InstName R16
SYMBOL res -560 560 R0
WINDOW 3 -18 39 VRight 2
SYMATTR Value {atten_Rshunt_out}
SYMATTR InstName R22
SYMBOL res -560 528 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 -53 65 VTop 2
SYMATTR InstName R23
SYMATTR Value {atten_Rser}
SYMBOL res -704 1152 R0
WINDOW 3 -18 39 VRight 2
SYMATTR Value {atten_Rshunt_in}
SYMATTR InstName R24
SYMBOL res -560 1152 R0
WINDOW 3 -18 39 VRight 2
SYMATTR Value {atten_Rshunt_out}
SYMATTR InstName R25
SYMBOL res -560 1120 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 -53 65 VTop 2
SYMATTR InstName R26
SYMATTR Value {atten_Rser}
SYMBOL res -704 1728 R0
WINDOW 3 -18 39 VRight 2
SYMATTR Value {atten_Rshunt_in}
SYMATTR InstName R27
SYMBOL res -560 1728 R0
WINDOW 3 -18 39 VRight 2
SYMATTR Value {atten_Rshunt_out}
SYMATTR InstName R28
SYMBOL res -560 1696 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 -53 65 VTop 2
SYMATTR InstName R29
SYMATTR Value {atten_Rser}
SYMBOL ind2 -592 -528 R180
WINDOW 3 36 40 Invisible 2
WINDOW 0 -22 83 VLeft 2
SYMATTR Value {TS1_Lmag}
SYMATTR InstName L101
SYMATTR Type ind
SYMATTR SpiceLine Rser={TS1_DCR} Rpar={TS1_Rmag} Cpar={TS1_Cp}
SYMBOL ind2 -592 -640 R180
WINDOW 3 36 40 Invisible 2
WINDOW 0 -24 85 VLeft 2
SYMATTR Value {TS1_Lmag}
SYMATTR InstName L102
SYMATTR Type ind
SYMATTR SpiceLine Rser={TS1_DCR} Rpar={TS1_Rmag} Cpar={TS1_Cp}
SYMBOL ind2 -592 -752 R180
WINDOW 3 36 40 Invisible 2
WINDOW 0 -19 83 VLeft 2
SYMATTR Value {TS1_Lmag}
SYMATTR InstName L103
SYMATTR Type ind
SYMATTR SpiceLine Rser={TS1_DCR} Rpar={TS1_Rmag} Cpar={TS1_Cp}
SYMBOL ind2 -592 -864 R180
WINDOW 3 36 40 Invisible 2
WINDOW 0 -20 80 VLeft 2
SYMATTR Value {TS1_Lmag}
SYMATTR InstName L104
SYMATTR Type ind
SYMATTR SpiceLine Rser={TS1_DCR} Rpar={TS1_Rmag} Cpar={TS1_Cp}
SYMBOL ind2 -688 -640 M180
WINDOW 3 36 40 Invisible 2
WINDOW 0 -15 29 VRight 2
SYMATTR Value {TS1_Lmag}
SYMATTR InstName L105
SYMATTR Type ind
SYMATTR SpiceLine Rser={TS1_DCR} Rpar={TS1_Rmag} Cpar={TS1_Cp}
SYMBOL ind2 -688 -752 M180
WINDOW 3 36 40 Invisible 2
WINDOW 0 -15 25 VRight 2
SYMATTR Value {TS1_Lmag}
SYMATTR InstName L106
SYMATTR Type ind
SYMATTR SpiceLine Rser={TS1_DCR} Rpar={TS1_Rmag} Cpar={TS1_Cp}
SYMBOL cap -928 -912 R270
WINDOW 3 89 27 VBottom 2
WINDOW 0 32 32 VTop 2
SYMATTR Value 100n
SYMATTR InstName C7
SYMBOL ind2 -208 -496 R180
WINDOW 3 36 40 Invisible 2
WINDOW 0 -17 31 VRight 2
SYMATTR Value {T2_Lmag}
SYMATTR InstName L204
SYMATTR Type ind
SYMATTR SpiceLine Rser={T2_DCR} Rpar={T2_Rmag} Cpar={T2_Cp}
SYMBOL ind2 -208 -608 R180
WINDOW 3 36 40 Invisible 2
WINDOW 0 -13 29 VRight 2
SYMATTR Value {T2_Lmag}
SYMATTR InstName L203
SYMATTR Type ind
SYMATTR SpiceLine Rser={T2_DCR} Rpar={T2_Rmag} Cpar={T2_Cp}
SYMBOL ind2 -208 -720 R180
WINDOW 3 36 40 Invisible 2
WINDOW 0 -16 29 VRight 2
SYMATTR Value {T2_Lmag}
SYMATTR InstName L202
SYMATTR Type ind
SYMATTR SpiceLine Rser={T2_DCR} Rpar={T2_Rmag} Cpar={T2_Cp}
SYMBOL ind2 -208 -832 R180
WINDOW 3 36 40 Invisible 2
WINDOW 0 -19 31 VRight 2
SYMATTR Value {T2_Lmag}
SYMATTR InstName L201
SYMATTR Type ind
SYMATTR SpiceLine Rser={T2_DCR} Rpar={T2_Rmag} Cpar={T2_Cp}
SYMBOL ind2 -304 -608 M180
WINDOW 3 36 40 Invisible 2
WINDOW 0 -16 85 VLeft 2
SYMATTR Value {T2_Lmag}
SYMATTR InstName L206
SYMATTR Type ind
SYMATTR SpiceLine Rser={T2_DCR} Rpar={T2_Rmag} Cpar={T2_Cp}
SYMBOL ind2 -304 -720 M180
WINDOW 3 36 40 Invisible 2
WINDOW 0 -17 89 VLeft 2
SYMATTR Value {T2_Lmag}
SYMATTR InstName L205
SYMATTR Type ind
SYMATTR SpiceLine Rser={T2_DCR} Rpar={T2_Rmag} Cpar={T2_Cp}
SYMBOL cap -96 -944 R90
WINDOW 3 -47 25 VTop 2
WINDOW 0 0 32 VBottom 2
SYMATTR Value {T2_C_cancel_leakage}
SYMATTR InstName C8
SYMBOL res -416 96 R0
SYMATTR InstName R30
SYMATTR Value {Rgbias2}
SYMBOL cap -416 80 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C12
SYMATTR Value {Cgbias}
SYMBOL res -416 720 R0
SYMATTR InstName R31
SYMATTR Value {Rgbias2}
SYMBOL cap -416 704 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C13
SYMATTR Value {Cgbias}
SYMBOL res -416 1296 R0
SYMATTR InstName R32
SYMATTR Value {Rgbias2}
SYMBOL cap -416 1280 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C14
SYMATTR Value {Cgbias}
SYMBOL res -416 1888 R0
SYMATTR InstName R33
SYMATTR Value {Rgbias2}
SYMBOL cap -416 1872 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C15
SYMATTR Value {Cgbias}
SYMBOL e -1408 -928 R0
SYMATTR InstName E1
SYMATTR Value Laplace = {1+alpha_z*s*tau_z/(1+s*tau_z)}
SYMBOL Opamps\\UniversalOpamp2 -800 2272 R0
SYMATTR InstName U1
SYMATTR Value2 Avol=1Meg GBW=50Meg Slew=10Meg
SYMATTR SpiceLine ilimit=1 rail=0 Vos=0 phimargin=45
SYMBOL voltage -304 2640 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value 15
SYMBOL res -944 2240 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R34
SYMATTR Value 10k
SYMBOL res -944 2320 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R35
SYMATTR Value 10k
SYMBOL res -944 2400 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R36
SYMATTR Value 10k
SYMBOL res -944 2480 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R37
SYMATTR Value 10k
SYMBOL voltage -1104 2592 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(0.1 {ID*Rs} {VG_tdelay} {VG_trise} {VG_trise} {VG_tpad*2+tpulse-VG_trise} 10m)
SYMATTR InstName V5
SYMBOL bv -1104 2688 R0
WINDOW 3 24 96 Invisible 2
SYMATTR Value V=ID*Rs*smallsig()
SYMATTR InstName B3
SYMBOL res -768 2112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R38
SYMATTR Value 10k
SYMBOL res -880 2576 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R39
SYMATTR Value 1k
SYMBOL cap -688 2112 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C16
SYMATTR Value 1n
SYMBOL voltage -144 2640 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value -5
SYMBOL res -1408 832 R0
SYMATTR InstName R40
SYMATTR Value {S1_Rs}
SYMBOL res -1456 528 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R41
SYMATTR Value {S1_Rfb}
SYMBOL cap -1632 624 R0
SYMATTR InstName C17
SYMATTR Value {S1_Cfb}
SYMBOL res -1824 768 R0
SYMATTR InstName R42
SYMATTR Value {S1_Rgbias}
SYMBOL res -1664 704 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R43
SYMATTR Value {S1_Rg_damp}
SYMBOL ind -1776 640 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L5
SYMATTR Value {S1_Lg_damp}
SYMBOL cap -1840 704 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C18
SYMATTR Value {S1_Csource}
SYMBOL ind -1408 720 R0
SYMATTR InstName L7
SYMATTR Value {Lpar_S}
SYMATTR SpiceLine Rpar={EPR_S}
SYMBOL ind -1408 544 R0
SYMATTR InstName L8
SYMATTR Value {Lpar_D}
SYMATTR SpiceLine Rpar={EPR_D}
SYMBOL ind -1552 736 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L9
SYMATTR Value {Lpar_G}
SYMATTR SpiceLine Rpar={EPR_G}
SYMBOL res -2400 736 R0
WINDOW 3 -18 39 VRight 2
SYMATTR Value {S1_atten_Rshunt_in}
SYMATTR InstName R48
SYMBOL res -2256 736 R0
WINDOW 3 -18 39 VRight 2
SYMATTR Value {S1_atten_Rshunt_out}
SYMATTR InstName R49
SYMBOL res -2256 704 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 -53 65 VTop 2
SYMATTR InstName R50
SYMATTR Value {S1_atten_Rser}
SYMBOL res -1824 880 R0
SYMATTR InstName R54
SYMATTR Value {S1_Rgbias2}
SYMBOL cap -1824 864 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C21
SYMATTR Value {S1_Cgbias}
SYMBOL ind2 -1120 1104 M180
WINDOW 3 36 40 Invisible 2
WINDOW 0 -22 83 VLeft 2
SYMATTR Value {T1_Lmag}
SYMATTR InstName L304
SYMATTR Type ind
SYMATTR SpiceLine Rser={T1_DCR} Rpar={T1_Rmag} Cpar={T1_Cp}
SYMBOL ind2 -1120 992 M180
WINDOW 3 36 40 Invisible 2
WINDOW 0 -24 85 VLeft 2
SYMATTR Value {T1_Lmag}
SYMATTR InstName L303
SYMATTR Type ind
SYMATTR SpiceLine Rser={T1_DCR} Rpar={T1_Rmag} Cpar={T1_Cp}
SYMBOL ind2 -1120 880 M180
WINDOW 3 36 40 Invisible 2
WINDOW 0 -19 83 VLeft 2
SYMATTR Value {T1_Lmag}
SYMATTR InstName L302
SYMATTR Type ind
SYMATTR SpiceLine Rser={T1_DCR} Rpar={T1_Rmag} Cpar={T1_Cp}
SYMBOL ind2 -1120 768 M180
WINDOW 3 36 40 Invisible 2
WINDOW 0 -20 80 VLeft 2
SYMATTR Value {T1_Lmag}
SYMATTR InstName L301
SYMATTR Type ind
SYMATTR SpiceLine Rser={T1_DCR} Rpar={T1_Rmag} Cpar={T1_Cp}
SYMBOL ind2 -1024 992 R180
WINDOW 3 36 40 Invisible 2
WINDOW 0 -15 29 VRight 2
SYMATTR Value {T1_Lmag}
SYMATTR InstName L306
SYMATTR Type ind
SYMATTR SpiceLine Rser={T1_DCR} Rpar={T1_Rmag} Cpar={T1_Cp}
SYMBOL ind2 -1024 880 R180
WINDOW 3 36 40 Invisible 2
WINDOW 0 -15 25 VRight 2
SYMATTR Value {T1_Lmag}
SYMATTR InstName L305
SYMATTR Type ind
SYMATTR SpiceLine Rser={T1_DCR} Rpar={T1_Rmag} Cpar={T1_Cp}
SYMBOL Opamps\\UniversalOpamp2 -1552 2256 R0
SYMATTR InstName U2
SYMATTR Value2 Avol=1Meg GBW=50Meg Slew=10Meg
SYMATTR SpiceLine ilimit=1 rail=0 Vos=0 phimargin=45
SYMBOL res -1696 2224 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R56
SYMATTR Value 10k
SYMBOL res -1696 2384 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R58
SYMATTR Value 10k
SYMBOL voltage -1856 2576 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(0.1 {S1_ID*S1_Rs} {VG_tdelay} {VG_trise} {VG_trise} {VG_tpad*2+tpulse-VG_trise} 10m)
SYMATTR InstName V7
SYMBOL bv -1856 2672 R0
WINDOW 3 24 96 Invisible 2
SYMATTR Value V=ID*Rs*smallsig()
SYMATTR InstName B4
SYMBOL res -1520 2096 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R60
SYMATTR Value 10k
SYMBOL res -1632 2560 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R61
SYMATTR Value 1k
SYMBOL cap -1440 2096 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C23
SYMATTR Value 1n
SYMBOL res -1408 1440 R0
SYMATTR InstName R44
SYMATTR Value {S1_Rs}
SYMBOL res -1456 1136 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R45
SYMATTR Value {S1_Rfb}
SYMBOL cap -1632 1232 R0
SYMATTR InstName C19
SYMATTR Value {S1_Cfb}
SYMBOL res -1824 1376 R0
SYMATTR InstName R46
SYMATTR Value {S1_Rgbias}
SYMBOL res -1664 1312 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R47
SYMATTR Value {S1_Rg_damp}
SYMBOL ind -1776 1248 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L6
SYMATTR Value {S1_Lg_damp}
SYMBOL cap -1840 1312 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C20
SYMATTR Value {S1_Csource}
SYMBOL ind -1408 1328 R0
SYMATTR InstName L10
SYMATTR Value {Lpar_S}
SYMATTR SpiceLine Rpar={EPR_S}
SYMBOL ind -1408 1152 R0
SYMATTR InstName L20
SYMATTR Value {Lpar_D}
SYMATTR SpiceLine Rpar={EPR_D}
SYMBOL ind -1552 1344 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L24
SYMATTR Value {Lpar_G}
SYMATTR SpiceLine Rpar={EPR_G}
SYMBOL res -2368 1344 R0
WINDOW 3 -18 39 VRight 2
SYMATTR Value {S1_atten_Rshunt_in}
SYMATTR InstName R51
SYMBOL res -2224 1344 R0
WINDOW 3 -18 39 VRight 2
SYMATTR Value {S1_atten_Rshunt_out}
SYMATTR InstName R52
SYMBOL res -2224 1312 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 -53 65 VTop 2
SYMATTR InstName R53
SYMATTR Value {S1_atten_Rser}
SYMBOL res -1824 1488 R0
SYMATTR InstName R55
SYMATTR Value {S1_Rgbias2}
SYMBOL cap -1824 1472 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C22
SYMATTR Value {S1_Cgbias}
SYMBOL res -480 -720 M0
SYMATTR InstName R57
SYMATTR Value 100
SYMBOL ind2 -832 -800 M180
WINDOW 3 -43 25 VRight 2
WINDOW 0 -15 25 VRight 2
SYMATTR Value 2.7µ
SYMATTR InstName L28
SYMATTR Type ind
SYMBOL nmos -1440 640 R0
SYMATTR InstName M5
SYMATTR Value irf520n
SYMATTR Prefix X
SYMBOL nmos -1440 1248 R0
SYMATTR InstName M6
SYMATTR Value irf520n
SYMATTR Prefix X
TEXT 416 -408 Left 2 !; main simulation statement\n; choose either AC or TRAN\n;.ac dec 1k 100k 200meg\n;.tran 0 {VG_tdelay+VG_tpad+tsettle_startlog+logperiods/f0} {0*VG_tdelay+0*VG_tpad+0*tsettle_startlog} 50n\n.tran 0 {VG_tdelay+VG_tpad+tsettle_startlog+logperiods/f0} {VG_tdelay+VG_tpad+tsettle_startlog} 50n\n \n; derive two port network parameters for AC analysis (can be left active when doing TRAN)\n.net I(RL) V2\n \n.OPTIONS reltol=0.0001\n \n; SPICE models/subcircuits to include\n.inc /Models and subcircuits/all_hexfet_subcircuits.inc\n \n; FOR MEASURING COMPRESSION\n.step oct param Vin_scale 0.0625 1 4\n.meas TRAN Vout_RMS_fund RMS V(OUT_bpf)\n;.meas TRAN Av_fund RMS {V(OUT_bpf)/(Vin/1.414/2)}\n.meas TRAN Av_fund PARAM Vout_RMS_fund/(Vin/1.414/2)\n.meas TRAN Pout_fund PARAM (Vout_RMS_fund**2/Rload_HV_SE)\n.meas TRAN G_dB PARAM 20*log10(Av_fund)\n.meas TRAN Pbias AVG -V(VD)*I(V1)\n.meas TRAN Efficiency PARAM Pout_fund/Pbias\n \n.meas TRAN S2_Vout_RMS_fund RMS V(OUT_bpf)\n.meas TRAN S1_Vout_RMS_fund RMS V(S1_dp,S1_dn)\n.meas TRAN S2_Av_fund PARAM S2_Vout_RMS_fund/(S1_Vout_RMS_fund)\n.meas TRAN S1_Av_fund PARAM S1_Vout_RMS_fund/(Vin/1.414/2)\n.meas TRAN S1_G_dB PARAM 20*log10(S1_Av_fund)\n.meas TRAN S2_G_dB PARAM 20*log10(S2_Av_fund)
TEXT 288 -1184 Left 2 ;trace formulas\nTransconductance of FET Gm0\nIx(M1:D)/V(g,s)\nEffective transconductance Gm\nIx(M1:D)/V(g)\nStability factor\n(1-abs(S11(v2))**2-abs(S22(v2))**2+abs(S11(v2)*S22(v2)-S12(v2)*S21(v2))**2)/(2*abs(S21(v2)*S12(v2)))\njust delta\nS11(v2)*S22(v2)-S12(v2)*S21(v2)
TEXT -2896 -632 Left 2 !;step 1: choose some basic specifications\n; the target overall PEP\n.param PEPnet_watts_target=200\n; choose how many pull-pull pairs will be in parallel\n.param Npar=2\n; the intended center frequency\n.param f0=5.1meg\n.param w0={2*pi*f0}\n; the bias voltage VD\n.param VD=48\n; define the nominal source/load impedances on the single-ended input/output \n.param Rsource_HV_SE=50\n.param Rload_HV_SE=50\n \n; step 2: determine input/output balun turn ratios\n; low voltage, center tapped sides\n.param KOUT_N_LV=1\n.param KIN_N_LV=1\n; high voltage, single ended sides\n.param KOUT_N_HV=4\n.param KIN_N_HV=4\n \n \n;step 3:\n.param ID=3.1\n.param Rs=0.707\n.param VG={ID*Rs+Vth}\n \n;step 4:\n.param Rgbias=100\n.param Rgbias2=10\n.param Cgbias=3.3n\n.param Rfb=150\n \n;step 5: choose components that influence frequency response\n.param Cfb=2.2n\n.param Csource=27n\n.param Ld=3.3u\n \n; step 6: design equations for a pi attenuator\n.param atten_Rshunt_in=75\n.param atten_Rshunt_out=75\n.param atten_Rser=4.99\n \n; step 7: define parasitics on power FETs\n.param Lpar_S=7.5n\n.param EPR_S=100\n.param Lpar_D=4.5n\n.param EPR_D=100\n.param Lpar_G=7.5n\n.param EPR_G=100\n \n; choose the damping network values\n.param Rg_damp=15\n.param Lg_damp=47n
TEXT 432 440 Left 2 ;;.meas PEP PARAM {PEP}\n.meas VD PARAM {VD}\n;.meas VDmin PARAM {VDmin}\n;.meas amp_Rload PARAM {amp_Rload}\n;.meas IDmin PARAM {IDmin}\n.meas ID PARAM {ID}\n.meas Gm0 PARAM {Gm0}\n;.meas Gm PARAM {Gm}\n.meas Rs PARAM {Rs}\n.meas Rgbias PARAM {Rgbias}\n;.meas amp_Rsource PARAM {amp_Rsource}\n.meas Rfb PARAM {Rfb}\n.meas Cfb PARAM {Cfb}\n.meas Csource PARAM {Csource}\n;.meas amp_Rin_target PARAM {amp_Rin_target}\n;.meas amp_Rin PARAM {amp_Rin}\n.meas VG PARAM {VG}\n.meas Coss PARAM {Coss}\n.meas Ld PARAM {Ld}\n;.meas KIN_LP PARAM {KIN_LP}\n;.meas KIN_LS PARAM {KIN_LS}\n;.meas KOUT_LP PARAM {KOUT_LP}\n;.meas KOUT_LS PARAM {KOUT_LS}\n.meas Rload_HV_SE PARAM {Rload_HV_SE}\n.meas Rsource_HV_SE PARAM {Rsource_HV_SE}
TEXT -1608 -648 Left 2 !; pulse shape, for tran simulations\n.param tpulse=200u\n.param VG_tpad=50u\n.param VG_trise=5u\n.param VG_tdelay=50u\n.param VG_init = 0\n.param tsettle_startlog=50u\n.param logperiods=2
TEXT -1224 -712 Left 2 !.param Vin_scale=0.8
TEXT 480 -624 Left 2 !.param bpf_w0={w0}\n.param bpf_R=100\n.param bpf_Q=10\n.param bpf_C={bpf_Q/(bpf_w0*bpf_R)}\n.param bpf_L={bpf_R/(bpf_Q*bpf_w0)}
TEXT 640 -864 Center 2 ;BPF for measuring fundamental \ncomponent of RFPA output
TEXT -648 -1240 Left 2 ;Input/output transformer baluns
TEXT 440 1656 Left 2 !; choose the approximate properties of the power FETs\n;.include /FET_bias_conditions/fetprops_irf510_ID_1p0.inc\n;.include /FET_bias_conditions/fetprops_irf520_ID_1p0.inc\n;.include /FET_bias_conditions/fetprops_irf520n_ID_1p0.inc\n;.include /FET_bias_conditions/fetprops_irf530_ID_1p0.inc\n;.include /FET_bias_conditions/fetprops_irf530n_ID_1p0.inc\n;.include /FET_bias_conditions/fetprops_irf540n_ID_1p0.inc\n;.include /FET_bias_conditions/fetprops_irf630_ID_1p0.inc\n;.include /FET_bias_conditions/fetprops_irf630n_ID_1p0.inc\n \n;.include /FET_bias_conditions/fetprops_irf510_ID_3p1.inc\n;.include /FET_bias_conditions/fetprops_irf520_ID_3p1.inc\n;.include /FET_bias_conditions/fetprops_irf520n_ID_3p1.inc\n;.include /FET_bias_conditions/fetprops_irf530_ID_3p1.inc\n;.include /FET_bias_conditions/fetprops_irf530n_ID_3p1.inc\n;.include /FET_bias_conditions/fetprops_irf540n_ID_3p1.inc\n.include /FET_bias_conditions/fetprops_irf630_ID_3p1.inc\n;.include /FET_bias_conditions/fetprops_irf630n_ID_3p1.inc
TEXT 440 1000 Left 2 !; define the rollet stability factor K\n.func kstab(S11,S21,S12,S22) {(1-abs(S11)**2-abs(S22)**2+abs(S11*S22-S12*S21)**2)/(2*abs(S21*S12))}\n \n; measurements of AC response\n; get some network parameters at f0\n.meas f0 PARAM {f0}\n.meas AC S21_at_f0 FIND mag(S21(v2)) AT f0\n.meas AC S11_at_f0 FIND mag(S11(v2)) AT f0\n.meas AC S22_at_f0 FIND mag(S22(v2)) AT f0\n.meas AC kstab_at_f0 FIND kstab(S11(v2),S21(v2),S12(v2),S22(v2)) AT f0\n;also give Zin and Zout at f0. But output will be in dB/phase....\n.meas AC Zin_at_f0 FIND mag(Zin(v2)) AT f0\n.meas AC Zout_at_f0 FIND mag(Zout(v2)) AT f0\n \n \n; find the actual peak of S21\n.MEAS AC S21_at_S21_max max mag(S21(v2)); find the peak response\n.MEAS AC f_at_S21_max when mag(S21(v2))=(S21_at_S21_max)\n \n; find the minimum kstab\n.MEAS AC kstab_at_stab_min min kstab(S11(v2),S21(v2),S12(v2),S22(v2))\n.MEAS AC f_at_kstab_min when kstab(S11(v2),S21(v2),S12(v2),S22(v2))=(kstab_at_stab_min)
TEXT -416 -1200 Left 2 !.param T2_Lmag=12.59u\n.param T2_Cp={804p/6}\n.param T2_K=0.997\n.param T2_Rmag={1.099K*6}\n.param T2_DCR=0.33\nK200 L201 L202 L203 L204 L205 L206 {T2_K}\n.param T2_C_cancel_leakage=3n
TEXT -1048 -1216 Left 2 !.param T1_Lmag=12.59u\n.param T1_Cp={804p/6}\n.param T1_K=0.997\n.param T1_Rmag={1.099K*6}\n.param T1_DCR=0.33\nK100 L101 L102 L103 L104 L105 L106 {T1_K}\n.param T1_C_cancel_leakage=3n
TEXT -1224 -736 Left 2 !.param Vin={2*4.9583*Vin_scale*0.92}
TEXT -1344 -1072 Left 2 !.param tau_z=2.2u\n.param alpha_z=0.7
TEXT -3896 -632 Left 2 !;step 3:\n.param S1_ID=1.5\n.param S1_Rs=2\n.param S1_VG={S1_ID*S1_Rs+Vth}\n \n;step 4:\n.param S1_Rgbias=500\n.param S1_Rgbias2=10\n.param S1_Cgbias=1n\n.param S1_Rfb=300\n \n;step 5: choose components that influence frequency response\n.param S1_Cfb=22n\n.param S1_Csource=10n\n.param S1_Ld=3.3u\n \n; step 6: design equations for a pi attenuator\n.param S1_atten_Rshunt_in=146\n.param S1_atten_Rshunt_out=146\n.param S1_atten_Rser=8.81\n \n; choose the damping network values\n.param S1_Rg_damp=15\n.param S1_Lg_damp=47n
TEXT -1360 488 Left 2 !K300 L301 L302 L303 L304 L305 L306 {T1_K}
TEXT -1232 -1536 Left 2 !.param TS1_Lmag=12.59u\n.param TS1_Cp=0\n.param TS1_K=0.997\n.param TS1_Rmag={1.099K*6}\n.param TS1_DCR=0.33\n.param TS1_C_cancel_leakage=3n
